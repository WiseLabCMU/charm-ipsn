\section{Introduction}
\label{sec:intro}

\begin{comment}
{\color{blue}
[ANTHONY, SWARUN, BOB]

Key points to cover
\begin{itemize}
\item LPWAN is emerging
\item Unlicensed spectrum $\rightarrow$ uncoordinated
\item Uncoordinated communication with long range $\rightarrow$ poor scaling
\item Coexistence is critical
\item LPWAN is device centric and energy constrained
\item LPWAN is like WiFi (free for all) but in the cellular arena (city-wide/ubiquitous)
\item Contributions are:
\begin{enumerate}
\item Benefits of coordination
\item Network management
\item Techniques and limits of LoRa localization
\item New platforms
\end{enumerate}
\end{itemize}
}
\end{comment}

{\color{red} Need new intro to align with current theme...}


New story line....

\begin{enumerate}
    \item Introduction:
        \begin{itemize}
            \item Motivation:
                \begin{itemize}
                    \item Community driven LP-WAN enables bring-your-own gateway (unlike cellular or WiFi)
                    \item User gateways are heterogeneous, unreliable and unstructured (Q. What is unstructured?)
                    \item Can we leverage the geographical diversity to increase sensitivity of the network. This in turn affects range, reliability and client power consumption (less power using lower spreading factor)
                \end{itemize}
            \item Brief Introduction to LoRa
            \item Contribution:
                \begin{itemize}
                    \item Leveraging diversity
                    \item A hardware platform and underlying algorithms for IQ processing
                    \item Software infrastructure to support data generated by a diversity-enabled system
                \end{itemize}
        \end{itemize}
    \item Related Work:
        \begin{itemize}
            \item SIMO (?) and diversity in WiFi/Cellular
            \item VLBA and telescopes: How to use an array of antennas to emulate a bigger receiver
            \item Cloud-RAN
            \item Local preamble detection and offloading
        \end{itemize}
    \item Diversity:
        \begin{itemize}
            \item Math
            \item Advantages
        \end{itemize}
        \item Limitations:
            \begin{itemize}
                \item Receivers need to be geographically separated (we naturally get this from BYOG)
                \item Lots of IQ data has to be sent around (our platform resolves this issue)
            \end{itemize}
        \item Possible extensions into full MU-MIMO (?), distributed tomography
    \item Platform:
        \begin{itemize}
            \item Is an auxiliary receiver on existing base-stations (instead of RTL-SDR)
            \item Block diagram + description + capabilities
            \item Local packet detection: 
                \begin{itemize}
                    \item IQ decoding
                    \item Math
                    \item What to transfer to the cloud
                \end{itemize}
        \end{itemize}
    \item System:
        \begin{itemize}
            \item General LoRaWAN architecture
            \item General OC architecture
            \item Supporting BYOBS architecture
            \item Supporting I/Q chunks
            \item Observations
                \begin{enumerate}
                    \item Lots of base-stations doing nothing all too important
                    \item User base-stations on unreliable, low-capacity networks
                \end{enumerate}
            \item How do we implement C-RAN
        \end{itemize}
    \item Experimental Results:
        \begin{itemize}
            \item Local packet detection: Error CDF vs SNR
            \item Diversity gain: SNR of preamble detection at different distances, Table of bit error rates
            \item Impact on client power: Effects on battery life on using lower spreading factors
            \item Increased capacity due to sensitivity gain (in simulation)
        \end{itemize}
    \item Conclusions and Future Work:
\end{enumerate}

Low Power Wide Area Networks (LP-WANs) are increasingly seen as an attractive communication platform for city-scale sensor deployments. LP-WANs offer the ability to wirelessly connect energy-poor sensor devices to base stations over distances of many miles. In deploy-once, never-touch-again, low bandwidth sensing applications, LP-WANs offer power and cost advantages over cellular networks.  While deployments are far from pervasive, the capabilities of LoRaWAN~\cite{Sornin2015, LoRaWanAlliance2015}, SigFox~\cite{centenaro2016} and Ingenu's RPMA~\cite{Ingenu2015} have attracted investment and have spawned early deployments.  

Across the board, LP-WAN technologies have adopted two key design principles at their core: a device-centric architecture and the use of unlicensed spectrum. First, LP-WANs are device-centric, giving the device the freedom to sleep (and save power) as it sees fit. This provides them an edge over competing 3GPP approaches such as LTE-M~\cite{GSMAssociation2016} and NB-IoT~\cite{Ratasuk2016} that are network-centric, requiring the devices to spend energy checking in regularly, even when they have no traffic to pass. Second, LP-WANs take advantage of  unlicensed, shared spectrum.  LoRa uses sub-GHz spectrum -- 433 and 868 MHz in Europe, 430 MHz in Asia, and the 915 MHz ISM band in the U.S.A. -- known for excellent long-range propagation characteristics (in contrast to WiFi at 2.4 GHz).\footnote{Similarly, SigFox -- a European effort -- uses the 868 MHz unlicensed band in Europe and the 915 MHz ISM band in the U.S.A.} Combine this with  the opening of TV-whitespace frequencies around the globe~\cite{FCC_Whitespaces}, and LP-WANs may bring us closer to the vision of an easy-to-deploy city-wide network enabled by inexpensive spectrum, serving smart sensors that are simple, low-cost, and low-power. 

%Importantly, because it is a spread-spectrum technology, LoRa can take advantage of higher transmit power levels subject to an FCC-imposed constraint of frequency hopping (47 CFR 15.247).  


%Combine this with  the opening of TV-whitespace frequencies~\cite{FCC_Whitespaces} and the frequency agility of LP-WAN chipsets, and one realizes that spectrum availability may not be the primary limiting factor in LP-WAN deployments.  In the USA, LoRa operates in the 915 MHz ISM band (902-928 MHz). 

Yet, achieving this vision remains challenging owing to two key design constraints -- the need for scalability and compliance to regulation. First, LP-WANs, with their low cost, good coverage and easy deployment, are likely to scale up rapidly, with the number of connected devices out-stripping cellular networks. However, operating at such scale in a device-centric network where nodes wake up and transmit on their own schedules can lead to collisions and channel saturation \cite{Abramson1970}. Second, the use of unlicensed spectrum is subject to important regulatory constraints. In particular, to transmit at high power on the sub-GHz unlicensed bands, the FCC-imposes a frequency hopping requirement\footnote{FCC Part 15 Regulations: 47 CFR 15.247}, complicating spectrum management. Further, transmitting in white spaces requires a node to be aware of its location to avoid interfering with licensed primary transmitters. Designing a system that manages spectrum access in LP-WANs without sacrificing its power advantages from device-centricity remains a fundamental challenge. 


%Given this, will the presumed power advantages of device-centric LP-WANs simply vanish?  How can we share channels effectively while preserving the power advantages of device-centricity?  We must find effective ways to coordinate spectrum access and to coexist.

%In this work, we examine anticipated scale and the frequency-hopping mandate as unique characteristics of LP-WANs that can be utilized to develop localization tools and to create channel management mechanisms.

% Next, we leverage the  scale of an LP-WAN network with a large number of devices at known locations to obtain a live spectrum map over a wide-area. We show how this facilitates a range of network management decisions -- spectrum allocation, network planning and interference mitigation, without imposing additional device complexity or relying on out-of-band mechanisms such as drive tests. We implement our system on the commodity LoRa LP-WAN system, given its spread-spectrum nature and compliance to FCC hopping norms. We present both experimental results to demonstrate system feasibility as well as trace-driven simulations to validate performance at scale. In order to promote community adoption,  our system is entirely LoRaWAN compliant. 



%We develop a mechanism to compute time-of-flight accurately between pairs of LP-WAN radios, which can then be used to compute their relative distances accurately. we develop a solution to accurately estimate time-of-flight between pairs of LP-WAN radios using RF-signal measurements gathered across multiple frequencies. Our approach demonstrates high accuracy in doing so, given that it. we develop a solution that exploits the frequency hopping of pairs of LP-WAN radios to. 

%The precision with which one can localize a wireless device is a function of the signal bandwidth \cite{rappaport}.  Mandatory hopping can be used to gather  and combine signal information across frequencies, resulting in more precise localization.  Further, with scale, it becomes possible to combine range information across nearby clients to infer location.

{\color{blue} \emph{Management}: Needs new text}

% Our approach to network management directly benefits from the scale of LP-WANs and regulation-mandated frequency hopping. By systematically collecting channel state information across devices, real-time large-scale channel state maps can be created, tagged with locations of devices.  While hopping provides sampling across a wide range of frequencies, the scale of LP-WANs provides dense sampling spatially. 

{\color{blue}\emph{Diversity}: Needs new text}

% Our system exploits the live spectrum heatmap to provide three services: spectrum allocation, network planning and interference mitigation. First, we devise an algorithm to allocate chunks of frequencies to neighboring base stations to avoid mutual interference using a graph-coloring approach. Unlike frequency tiling in the cellular space~\cite{mcdiarmid2000channel, khanna1998wireless}, our approach actively accounts for LP-WAN specific peculiarities, such as frequency hopping, spread spectrum, and interactions between multiple interfering sources. For instance, we demonstrate how cellular and Wi-Fi truisms, such as associating with the closest base station or picking the highest possible data rate for a given client, may not always be in its best interest in the LP-WAN context. Second, we facilitate better network planning by identifying optimal locations to deploy new base stations. We do so by emulating deployment of a new base station by collating signal measurements from teams of co-located LP-WAN client devices, already present in the network. This assists network managers in assessing the impact of placing a new base station in their vicinity, without resorting to expensive drive tests. Finally, we present a solution to mitigate interfering sources, by quickly identifying their presence -- using crowd-sourced measurements from sensor devices. 

{\color{blue} With some additional context....}
Our network management system is intrinsically designed to only exploit sensor clients that are currently awake, preserving the power advantages of the device-centric LP-WAN architecture. 

We evaluate our system both through proof-of-concept experiments and large-scale trace-driven simulations. We implement our system on commodity LoRa base stations and clients, {\color{blue} custom platform ??}. We perform experiments both in indoor and outdoor spaces across a large university campus. Our results reveal the following:

\begin{itemize}
\item \textbf{Management: } {\color{blue} Add 1 line about results} 
\item \textbf{Diversity: } {\color{blue} Add 1 line about results}
\item \textbf{Platform: } {\color{blue} Add 1 line about results}
\end{itemize}

\textbf{Contributions}: This paper presents:
\begin{tightitem}
\item OC platform and architecture
\item About the use of diversity
\item Platform for cheaply streaming I/Q values
\end{tightitem}
